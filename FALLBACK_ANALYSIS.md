# –ê–Ω–∞–ª–∏–∑ Fallback-–º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ—à–∞–≥–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö fallback-–º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ –∏ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤.

## ‚úÖ –°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

**–í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ fallback-—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:**

- ‚úÖ `DB_PASSWORD` - —Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ `JWT_SECRET` - —Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ `CORS` - —Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è (–±–µ–∑ fallback –Ω–∞ `'*'`)
- ‚úÖ `TELEGRAM_BOT_TOKEN` - —Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ `TELEGRAM_ADMIN_CHAT_ID` - —Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ IP fallback - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ `'unknown'`
- ‚úÖ Death Year fallback - –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤–æ–ø—Ä–æ—Å –æ —Å–º–µ—Ä—Ç–∏ –±–µ–∑ –≥–æ–¥–∞ —Å–º–µ—Ä—Ç–∏
- ‚úÖ Lists Service JWT secret - —É–±—Ä–∞–Ω fallback –Ω–∞ `'dev-secret'`

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ Fallback-–æ–≤

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (config/index.ts)

#### 1.1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

- **`DB_HOST || 'localhost'`** - ‚úÖ –û–ö –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –Ω–æ –≤ production –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º
- **`DB_PASSWORD`** - ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –±–µ–∑ fallback-–∞
- **`DB_NAME || 'chrononinja'`** - ‚úÖ –û–ö, –Ω–æ –ª—É—á—à–µ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å
- **`DB_USER || 'postgres'`** - ‚úÖ –û–ö –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - `DB_PASSWORD` —Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –±–µ–∑ –Ω–µ—ë.

#### 1.2. JWT

- **`JWT_SECRET`** - ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –±–µ–∑ fallback-–∞

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - `JWT_SECRET` —Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –±–µ–∑ –Ω–µ—ë.

#### 1.3. CORS

- **`process.env.CORS || process.env.CORS_ORIGIN || process.env.CORS_ORIGINS`** - ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –±–µ–∑ fallback-–∞ –Ω–∞ `'*'`

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - CORS —Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –±–µ–∑ –Ω–µ—ë.

#### 1.4. Telegram

- **`TELEGRAM_BOT_TOKEN`** - ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –±–µ–∑ fallback-–∞
- **`TELEGRAM_ADMIN_CHAT_ID`** - ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –±–µ–∑ fallback-–∞

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - Telegram —Ç–æ–∫–µ–Ω—ã —Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –ü—Ä–∏ –∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, –∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ –≤–º–µ—Å—Ç–æ –º–æ–ª—á–∞–ª–∏–≤–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è.

---

### 2. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (middleware/auth.ts)

#### 2.1. IP –∞–¥—Ä–µ—Å

```typescript
// –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ IP —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ fallback-–∞–º–∏
// –ü—ã—Ç–∞–µ—Ç—Å—è –∏–∑–≤–ª–µ—á—å IP –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
// –í –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ `'unknown'`, —á—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å rate limiting.

#### 2.2. –†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```typescript
const role = req.user.role || 'user';
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –û–ö - —Ä–∞–∑—É–º–Ω—ã–π fallback.

---

### 3. Quiz Service (services/quizService.ts)

#### 3.1. –†–∞—Å—á—ë—Ç —Ä–µ–π—Ç–∏–Ω–≥–∞

```typescript
// –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞
if (!detailedAnswers || detailedAnswers.length === 0) {
  throw new Error('–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ç–≤–µ—Ç–∞—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞...');
}
return this.calculateDetailedRatingPoints(detailedAnswers, totalQuestions);
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –°—Ç–∞—Ä—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —É–¥–∞–ª—ë–Ω. –¢–µ–ø–µ—Ä—å `detailedAnswers` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –∏ –ø—Ä–∏ –µ–≥–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞.

**–†–µ—à–µ–Ω–∏–µ**: –£–±—Ä–∞–Ω fallback –Ω–∞ —Å—Ç–∞—Ä—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º. –¢–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—á–Ω—ã–π –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á—ë—Ç–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞.

#### 3.2. –°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–æ–ø—Ä–æ—Å–∞

```typescript
if (!(questionType in difficultyMap)) {
  throw new Error(`–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –≤–æ–ø—Ä–æ—Å–∞: ${questionType}...`);
}
return difficultyMap[questionType];
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - Fallback –Ω–∞ 0 —É–±—Ä–∞–Ω. –¢–µ–ø–µ—Ä—å –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞.

**–†–µ—à–µ–Ω–∏–µ**: –£–±—Ä–∞–Ω fallback –Ω–∞ 0. –¢–µ–ø–µ—Ä—å –ø—Ä–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–º —Ç–∏–ø–µ –≤–æ–ø—Ä–æ—Å–∞ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞, —á—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∏—Å–∫–∞–∂–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞.

#### 3.3. Username –≤ leaderboard

```typescript
username: row.username || 'Unknown',
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –û–ö - —Ä–∞–∑—É–º–Ω—ã–π fallback –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.

---

### 4. Routes

#### 4.1. Periods Routes (routes/periodsRoutes.ts)

```typescript
return 'user'; // fallback –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ä–æ–ª–µ–π
```

**–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê: –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è —Ä–æ–ª—å –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ `'user'`, —á—Ç–æ –º–æ–∂–µ—Ç –¥–∞—Ç—å –±–æ–ª—å—à–µ –ø—Ä–∞–≤, —á–µ–º –Ω—É–∂–Ω–æ, –∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç - –º–µ–Ω—å—à–µ.

**–ü—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ —Ä–æ–ª—å –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞ –∏–ª–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∞–≤–∞ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.

#### 4.2. Meta Routes (routes/metaRoutes.ts)

```typescript
const data = await fallback();
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –û–ö - —ç—Ç–æ –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è, fallback —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–µ—à–∞.

---

### 5. Lists Service (services/listsService.ts)

#### 5.1. –ù–∞–∑–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ

```typescript
const fallbackTitle = src.rows[0].title || '–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫';
const t0 = (newTitle || '').trim();
const finalTitle = t0.length > 0 ? t0 : fallbackTitle;
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –û–ö - —Ä–∞–∑—É–º–Ω—ã–π fallback, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–ª—É—á—à–µ–Ω:

- –ï—Å–ª–∏ `src.rows[0].title` —Ç–æ–∂–µ –ø—É—Å—Ç–æ–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `'–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫'`
- –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é –Ω–∞–∑–≤–∞–Ω–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ —É –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –Ω–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è, –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –±—É–¥—É—Ç –∏–º–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ `'–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫'`.

---

### 6. Frontend - Quiz (features/quiz/)

#### 6.1. Fallback Generator (generators/fallbackGenerator.ts)

##### 6.1.1. Death Year

**–í `fallbackGenerator.ts`:**

```typescript
// –ù–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤–æ–ø—Ä–æ—Å –æ —Å–º–µ—Ä—Ç–∏, –µ—Å–ª–∏ –Ω–µ—Ç –≥–æ–¥–∞ —Å–º–µ—Ä—Ç–∏
// –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤–æ–ø—Ä–æ—Å –æ –≥–æ–¥–µ —Ä–æ–∂–¥–µ–Ω–∏—è
if (!person.deathYear) {
  return {
    /* –≤–æ–ø—Ä–æ—Å –æ –≥–æ–¥–µ —Ä–æ–∂–¥–µ–Ω–∏—è */
  };
}
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –¢–µ–ø–µ—Ä—å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–∫—É—â–∏–π –≥–æ–¥ –∫–∞–∫ fallback. –ï—Å–ª–∏ –Ω–µ—Ç –≥–æ–¥–∞ —Å–º–µ—Ä—Ç–∏, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤–æ–ø—Ä–æ—Å –æ –≥–æ–¥–µ —Ä–æ–∂–¥–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –≤–æ–ø—Ä–æ—Å–∞ –æ —Å–º–µ—Ä—Ç–∏.

**–†–µ—à–µ–Ω–∏–µ**: –£–±—Ä–∞–Ω–∞ –ø—Ä–æ–±–ª–µ–º–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ fallback-–æ–≤. –¢–µ–ø–µ—Ä—å `generateSimpleFallback` –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤–æ–ø—Ä–æ—Å –æ —Å–º–µ—Ä—Ç–∏, –µ—Å–ª–∏ –Ω–µ—Ç –≥–æ–¥–∞ —Å–º–µ—Ä—Ç–∏.

##### 6.1.2. Options –≤ –≤–æ–ø—Ä–æ—Å–∞—Ö (fallbackGenerator.ts)

**Country options:**

```typescript
// –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
const allCountriesSet = new Set<string>();
persons.forEach(p => {
  /* ... */
});
// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω
const countryOptions = [correctCountry];
while (countryOptions.length < 4) {
  const randomCountry = allCountriesArray[Math.floor(Math.random() * allCountriesArray.length)];
  if (!countryOptions.includes(randomCountry)) {
    countryOptions.push(randomCountry);
  }
}
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç—Ä–∞–Ω—ã –∏–∑ API (`allCountries`), –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã, –∏–Ω–∞—á–µ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ `persons`.

**–†–µ—à–µ–Ω–∏–µ**: –£–±—Ä–∞–Ω—ã —Ö–∞—Ä–¥–∫–æ–¥–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã `['–§—Ä–∞–Ω—Ü–∏—è', '–ì–µ—Ä–º–∞–Ω–∏—è', '–ò—Ç–∞–ª–∏—è']`. –¢–µ–ø–µ—Ä—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç—Ä–∞–Ω—ã –∏–∑ API (`allCountries`), —á—Ç–æ –¥–∞—ë—Ç –±–æ–ª—å—à–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –≤ –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö –æ—Ç–≤–µ—Ç–æ–≤ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞.

**Profession options:**

```typescript
// –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
const allCategoriesSet = new Set(persons.map(p => p.category));
// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
const professionOptions = [person.category];
while (professionOptions.length < 4) {
  const randomCategory = allCategoriesArray[Math.floor(Math.random() * allCategoriesArray.length)];
  if (!professionOptions.includes(randomCategory)) {
    professionOptions.push(randomCategory);
  }
}
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ API (`allCategories`), –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã, –∏–Ω–∞—á–µ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ `persons`.

**–†–µ—à–µ–Ω–∏–µ**: –£–±—Ä–∞–Ω—ã —Ö–∞—Ä–¥–∫–æ–¥–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã `['–ü–∏—Å–∞—Ç–µ–ª—å', '–•—É–¥–æ–∂–Ω–∏–∫', '–ü–æ–ª–∏—Ç–∏–∫']`. –¢–µ–ø–µ—Ä—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ API (`allCategories`), —á—Ç–æ –¥–∞—ë—Ç –±–æ–ª—å—à–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è –≤ –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö –æ—Ç–≤–µ—Ç–æ–≤ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞.

#### 6.2. useQuiz Hook (hooks/useQuiz.ts)

##### 6.2.1. Death Year –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

```typescript
const deathYear = person.deathYear || new Date().getFullYear();
const matchesTimeRange =
  deathYear >= debouncedTimeRange.start && person.birthYear <= debouncedTimeRange.end;
```

**–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê: –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ fallback generator - –¥–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π —ç—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.

##### 6.2.2. Fallback types –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤

```typescript
const fallbackPool = simpleMode
  ? simpleQuestionTypes
  : ['birthYear', 'deathYear', 'profession', 'country'];
const fallbackTypes = fallbackPool.filter(checkQuestionAvailability);
const finalAvailableTypes =
  availablePreferredTypes.length > 0 ? availablePreferredTypes : fallbackTypes;
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –û–ö - —Ä–∞–∑—É–º–Ω—ã–π fallback, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–ª—É—á—à–µ–Ω:

- –ï—Å–ª–∏ `fallbackTypes` —Ç–æ–∂–µ –ø—É—Å—Ç–æ–π, –≤–µ—Ä–Ω—ë—Ç—Å—è –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
- –≠—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞—á–∞—Ç—å –∫–≤–∏–∑

**–ü—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∏–ø–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–∞–∂–µ –≤ fallback pool, –∫–≤–∏–∑ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞—á–∞—Ç, –Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –Ω–µ –ø–æ–Ω—è—Ç—å –ø–æ—á–µ–º—É.

##### 6.2.3. Question type fallback

```typescript
const question = questions[index];
if (!question) {
  throw new Error(`–í–æ–ø—Ä–æ—Å —Å –∏–Ω–¥–µ–∫—Å–æ–º ${index} –Ω–µ –Ω–∞–π–¥–µ–Ω...`);
}
if (!question.type) {
  throw new Error(`–¢–∏–ø –≤–æ–ø—Ä–æ—Å–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞ —Å –∏–Ω–¥–µ–∫—Å–æ–º ${index}...`);
}
questionType: question.type,
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –£–±—Ä–∞–Ω fallback –Ω–∞ `'birthYear'`. –¢–µ–ø–µ—Ä—å –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –≤–æ–ø—Ä–æ—Å–∞ –∏–ª–∏ —Ç–∏–ø–∞ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞.

**–†–µ—à–µ–Ω–∏–µ**: –£–±—Ä–∞–Ω fallback –Ω–∞ `'birthYear'`. –¢–µ–ø–µ—Ä—å –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –≤–æ–ø—Ä–æ—Å–∞ –∏–ª–∏ —Ç–∏–ø–∞ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º, —á—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—Ç–≤–µ—Ç–∞ –∏ —Ä–∞—Å—á—ë—Ç —Ä–µ–π—Ç–∏–Ω–≥–∞.

---

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (—Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

‚úÖ **–í–°–ï –ö–†–ò–¢–ò–ß–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò–°–ü–†–ê–í–õ–ï–ù–´:**

1. ‚úÖ **DB_PASSWORD fallback** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
2. ‚úÖ **JWT_SECRET fallback** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
3. ‚úÖ **CORS fallback –Ω–∞ '\*'** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
4. ‚úÖ **Death Year fallback –Ω–∞ —Ç–µ–∫—É—â–∏–π –≥–æ–¥** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –ù–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤–æ–ø—Ä–æ—Å –æ —Å–º–µ—Ä—Ç–∏ –±–µ–∑ –≥–æ–¥–∞ —Å–º–µ—Ä—Ç–∏
5. ‚úÖ **IP fallback –Ω–∞ 'unknown'** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä

### üü° –í–∞–∂–Ω—ã–µ (—Ç—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è)

1. ‚úÖ **Telegram —Ç–æ–∫–µ–Ω—ã** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
2. ‚úÖ **–°—Ç–∞—Ä—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–µ–π—Ç–∏–Ω–≥–∞** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –£–¥–∞–ª—ë–Ω, —Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º
3. ‚úÖ **Difficulty fallback –Ω–∞ 0** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤
4. **–†–æ–ª—å fallback –Ω–∞ 'user'** - –º–æ–∂–µ—Ç –¥–∞—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ (–ø—Ä–∏–Ω—è—Ç–æ –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ)
5. ‚úÖ **–•–∞—Ä–¥–∫–æ–¥–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã
6. ‚úÖ **Question type fallback** - **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ç–∏–ø–∞

### üü¢ –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ (–º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å)

1. **–ù–∞–∑–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ** - –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é
2. **Username fallback** - –ø—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
3. **Fallback types –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤** - –º–æ–∂–µ—Ç –±—ã—Ç—å —É–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç–æ–≥–æ –º–∞—Å—Å–∏–≤–∞

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- –£–±—Ä–∞—Ç—å –≤—Å–µ fallback-–∏ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ production
- –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–≥—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏ –¥–ª—è dev/prod

### 2. Death Year

- –†–∞–∑–ª–∏—á–∞—Ç—å –∂–∏–≤—ã—Ö –∏ —É–º–µ—Ä—à–∏—Ö –ª—é–¥–µ–π
- –î–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π –±–µ–∑ –≥–æ–¥–∞ —Å–º–µ—Ä—Ç–∏ - –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –æ —Å–º–µ—Ä—Ç–∏
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, `null` –æ–∑–Ω–∞—á–∞–µ—Ç "–∂–∏–≤")

### 3. Fallback Generator

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –≤ options
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã

### 4. Quiz Service

- –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ fallback-–∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø—ã –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–µ—Ä–µ–¥ —Ä–∞—Å—á—ë—Ç–æ–º —Ä–µ–π—Ç–∏–Ω–≥–∞

### 5. IP –∞–¥—Ä–µ—Å

- –£–ª—É—á—à–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP —Å —É—á—ë—Ç–æ–º —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–æ–∫—Å–∏
- –î–ª—è rate limiting –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏—é IP + User-Agent –∏–ª–∏ –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —Å–ª—É—á–∞–∏

### 7. Lists Service - JWT Secret

```typescript
const jwtSecret = process.env.JWT_SECRET || process.env.JWT_ACCESS_SECRET;
if (!jwtSecret) {
  throw new Error('JWT_SECRET –∏–ª–∏ JWT_ACCESS_SECRET –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!');
}
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - Fallback –Ω–∞ `'dev-secret'` —É–±—Ä–∞–Ω. –¢–µ–ø–µ—Ä—å –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞, –µ—Å–ª–∏ —Å–µ–∫—Ä–µ—Ç –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω.

### 8. Contemporaries Generator

–í `contemporariesGenerator.ts`:

```typescript
const death1 = person1.deathYear || new Date().getFullYear();
const death2 = person2.deathYear || new Date().getFullYear();
```

**–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê: –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥—Ä—É–≥–∏–º –º–µ—Å—Ç–∞–º - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –≥–æ–¥–∞ –¥–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π.

**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–æ–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å, –±—ã–ª–∏ –ª–∏ –¥–≤–∞ —á–µ–ª–æ–≤–µ–∫–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∏–∫–∞–º–∏.

### 9. Timeline Components

–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```typescript
person.deathYear ?? new Date().getFullYear();
```

**–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê: –î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ timeline —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–µ–º–ª–µ–º–æ, –Ω–æ –Ω—É–∂–Ω–æ —Ä–∞–∑–ª–∏—á–∞—Ç—å:

- –ñ–∏–≤—ã–µ –ª—é–¥–∏ (deathYear = null) ‚Üí —Ç–µ–∫—É—â–∏–π –≥–æ–¥
- –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏ –±–µ–∑ –≥–æ–¥–∞ —Å–º–µ—Ä—Ç–∏ ‚Üí –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ

---

## –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–±–ª–µ–º

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è      | –§–∞–π–ª                                  | –ü—Ä–æ–±–ª–µ–º–∞                  | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å   | –°—Ç–∞—Ç—É—Å                   |
| -------------- | ------------------------------------- | ------------------------- | ------------- | ------------------------ |
| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è   | config/index.ts                       | DB_PASSWORD fallback      | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ   | ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**        |
| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è   | config/index.ts                       | JWT_SECRET fallback       | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ   | ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**        |
| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è   | config/index.ts                       | CORS fallback –Ω–∞ '\*'     | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ   | ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**        |
| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è   | config/index.ts                       | Telegram —Ç–æ–∫–µ–Ω—ã           | üü° –í–∞–∂–Ω–æ      | ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**        |
| –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | middleware/auth.ts                    | IP fallback –Ω–∞ 'unknown'  | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ   | ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**        |
| Quiz Service   | services/quizService.ts               | –°—Ç–∞—Ä—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–µ–π—Ç–∏–Ω–≥–∞  | üü° –í–∞–∂–Ω–æ      | ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**        |
| Quiz Service   | services/quizService.ts               | Difficulty fallback –Ω–∞ 0  | üü° –í–∞–∂–Ω–æ      | ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**        |
| Routes         | routes/periodsRoutes.ts               | –†–æ–ª—å fallback –Ω–∞ 'user'   | üü° –í–∞–∂–Ω–æ      | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞       |
| Lists Service  | services/listsService.ts              | JWT secret fallback       | ‚ö†Ô∏è –í–∞–∂–Ω–æ      | ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**        |
| Lists Service  | services/listsService.ts              | –ù–∞–∑–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞           | üü¢ –ù–µ–∫—Ä–∏—Ç–∏—á–Ω–æ | –ú–æ–∂–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è      |
| Frontend       | generators/fallbackGenerator.ts       | Death year –Ω–∞ —Ç–µ–∫—É—â–∏–π –≥–æ–¥ | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ   | ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**        |
| Frontend       | generators/fallbackGenerator.ts       | –•–∞—Ä–¥–∫–æ–¥–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã       | üü° –í–∞–∂–Ω–æ      | ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**        |
| Frontend       | hooks/useQuiz.ts                      | Death year –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ | üü° –í–∞–∂–Ω–æ      | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è  |
| Frontend       | hooks/useQuiz.ts                      | Question type fallback    | üü° –í–∞–∂–Ω–æ      | ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**        |
| Frontend       | generators/contemporariesGenerator.ts | Death year fallback       | üü° –í–∞–∂–Ω–æ      | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ |

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:**
   - ‚úÖ –£–±—Ä–∞–Ω—ã fallback-–∏ –¥–ª—è DB_PASSWORD, JWT_SECRET, CORS (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
   - ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω IP fallback –¥–ª—è rate limiting (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä)
   - ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω deathYear fallback –≤ fallbackGenerator (–Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤–æ–ø—Ä–æ—Å –±–µ–∑ –≥–æ–¥–∞ —Å–º–µ—Ä—Ç–∏)

2. ‚úÖ **–í–∞–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:**
   - ‚úÖ –£–¥–∞–ª—ë–Ω —Å—Ç–∞—Ä—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–µ–π—Ç–∏–Ω–≥–∞ (—Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω—ã–π)
   - ‚úÖ –£–±—Ä–∞–Ω fallback –Ω–∞ 0 –¥–ª—è difficulty (—Ç–µ–ø–µ—Ä—å –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞)
   - ‚úÖ –£–±—Ä–∞–Ω—ã fallback-–∏ –¥–ª—è Telegram —Ç–æ–∫–µ–Ω–æ–≤ (—Ç–µ–ø–µ—Ä—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
   - ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ö–∞—Ä–¥–∫–æ–¥–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ (—Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
   - ‚úÖ –£–±—Ä–∞–Ω question type fallback (—Ç–µ–ø–µ—Ä—å –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞)

3. **–£–ª—É—á—à–∏—Ç—å –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ:**
   - –£–ª—É—á—à–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –Ω–∞–∑–≤–∞–Ω–∏–π —Å–ø–∏—Å–∫–æ–≤
   - –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ fallback-–æ–≤

4. **–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã:**
   - –¢–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ fallback-–º–µ—Ö–∞–Ω–∏–∑–º–∞
   - –¢–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ fallback-–ø–æ–≤–µ–¥–µ–Ω–∏—è
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö fallback-–æ–≤

5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å:**
   - –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ fallback-–∞
   - –ö–æ–≥–¥–∞ fallback –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è
   - –ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö
