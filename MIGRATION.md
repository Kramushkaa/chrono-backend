# –ú–∏–≥—Ä–∞—Ü–∏—è —Å simple-server.js –Ω–∞ src/server.ts

## ‚úÖ –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–ù–æ–≤—ã–π TypeScript —Å–µ—Ä–≤–µ—Ä (`src/server.ts`) –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º —Å–æ —Å—Ç–∞—Ä—ã–º `simple-server.js` –∏ –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–∏:

### üîÑ –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

#### 1. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Amvera
- ‚úÖ SSL –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å —Ç–∞–π–º–∞—É—Ç–∞–º–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

#### 2. **–í—Å–µ API –º–∞—Ä—à—Ä—É—Ç—ã**
- ‚úÖ `GET /` - –ö–æ—Ä–Ω–µ–≤–æ–π –º–∞—Ä—à—Ä—É—Ç —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º API
- ‚úÖ `GET /api/persons` - –°–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ª–∏—á–Ω–æ—Å—Ç–µ–π —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- ‚úÖ `GET /api/persons/:id` - –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –ø–æ ID
- ‚úÖ `GET /api/categories` - –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- ‚úÖ `GET /api/countries` - –°–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω
- ‚úÖ `GET /api/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

#### 3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫**
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º: `?category=–ü—Ä–∞–≤–∏—Ç–µ–ª—å,–£—á–µ–Ω—ã–π`
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∞–º: `?country=–°–®–ê,–ì–µ—Ä–º–∞–Ω–∏—è`
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≥–æ–¥–∞–º: `?startYear=1800&endYear=1900`

#### 4. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø–æ–ª—è –¥–∞–Ω–Ω—ã—Ö**
- ‚úÖ `reignStart`, `reignEnd` (–¥–ª—è –ø—Ä–∞–≤–∏—Ç–µ–ª–µ–π)
- ‚úÖ `achievementYear1`, `achievementYear2`, `achievementYear3`
- ‚úÖ `imageUrl` –≤–º–µ—Å—Ç–æ `image_url`

#### 5. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏**
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `unique_categories` –∏ `unique_countries`
- ‚úÖ Fallback –Ω–∞ `DISTINCT` –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç

#### 6. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ ID –≤ –º–∞—Ä—à—Ä—É—Ç–∞—Ö
- ‚úÖ Graceful shutdown
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

### üÜï –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

#### 1. **–°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**
- ‚úÖ –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/–≤—Ö–æ–¥–∞
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã
- ‚úÖ –†–æ–ª–∏ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- ‚úÖ –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

#### 2. **–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
- ‚úÖ TypeScript
- ‚úÖ Express.js –≤–º–µ—Å—Ç–æ –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ HTTP
- ‚úÖ Middleware –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

#### 3. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
- ‚úÖ Rate limiting
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π

## üöÄ –ö–∞–∫ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è:

### 1. **–û–±–Ω–æ–≤–∏—Ç–µ package.json**
```json
{
  "main": "src/server.ts",
  "scripts": {
    "start": "ts-node src/server.ts",
    "dev": "nodemon --exec ts-node src/server.ts"
  }
}
```

### 2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
```bash
npm install
```

### 3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä**
```bash
npm run dev
```

### 4. **–£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª**
```bash
rm simple-server.js
```

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ù–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ –∂–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```env
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
PORT=3001
NODE_ENV=development

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
DB_HOST=chronoline-kramushka.db-msk0.amvera.tech
DB_PORT=5432
DB_NAME=chronoline
DB_USER=Kramushka
DB_PASSWORD=1qwertyu

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ JWT (–Ω–æ–≤—ã–µ)
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_EXPIRES_IN=24h
REFRESH_TOKEN_EXPIRES_IN=7d

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ CORS
CORS_ORIGIN=*
```

## üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

–í—Å–µ —Å—Ç–∞—Ä—ã–µ API –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

```bash
# –ö–æ—Ä–Ω–µ–≤–æ–π –º–∞—Ä—à—Ä—É—Ç
curl http://localhost:3001/

# –°–ø–∏—Å–æ–∫ –ª–∏—á–Ω–æ—Å—Ç–µ–π
curl http://localhost:3001/api/persons

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
curl "http://localhost:3001/api/persons?category=–ü—Ä–∞–≤–∏—Ç–µ–ª—å&country=–†–æ—Å—Å–∏—è&startYear=1800&endYear=1900"

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å
curl http://localhost:3001/api/persons/1

# –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
curl http://localhost:3001/api/categories

# –°—Ç—Ä–∞–Ω—ã
curl http://localhost:3001/api/countries

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
curl http://localhost:3001/api/stats
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞:

1. **–ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç
2. **–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏** - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
3. **–õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - Express.js –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
4. **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - TypeScript
5. **–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –º–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
6. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - rate limiting, –≤–∞–ª–∏–¥–∞—Ü–∏—è
7. **–õ—É—á—à–µ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:

1. **–°—Ç–∞—Ä—ã–π —Ñ–∞–π–ª —É–¥–∞–ª–µ–Ω** - `simple-server.js` –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω
2. **–ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
3. **TypeScript** - –∫–æ–¥ —Ç–µ–ø–µ—Ä—å —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω
4. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –Ω–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã `/api/auth/*`

–ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ! üéâ 